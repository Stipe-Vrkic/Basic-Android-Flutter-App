workflows:
  default-workflow:
    name: Default Workflow
    max_build_duration: 10
    environment:
      vars:
        FCI_KEYSTORE_PATH: /tmp/keystore.keystore
        FCI_KEYSTORE: Encrypted(Z0FBQUFBQmp4bE9FMDJJNkZ1alJ5ZW85dTNIYjZ5NjlSb09NWkp6aTlWQkltYjByRWJTRHN6QmRTaVBYTHNvWkJ2ZXp1X0N5dmloemwwZXpFU19qU2NsdW1OR0hZcnlkalRuZzlhY0ptaW1MTXVNbnFzaURqZUl1Rjk1VVBXVENkeGRYUHRZVmtlSVlaZEZpaE1lTGdYdk4zblZkQXd4c3VwZ01pOUJyS0VkVngxSE9Mbm5QaC0xdk9NSEgyWmZDQXpNQm50am9MWkFHelA5V1ZqZXEySzJQeUhtZV9lU21fbkJJS1FwaGN1b2Z2SmFEaUI2NS1zek9oa1lSZXd3Vm41ZUQyOEpkaUZkN29nY1c5WWdyUzc1ZjVfdTJCTjVnQlZGeElIaVllT0xuRU1tVHdWRHBLVC1BUlB6anJoX19wR2pydDNpUm5YTU1vd3lkaG1XN0gyTGZ4WnRXcWdPUl9KdGVpRHd0WEk1UHEwWU80RzdDUzRkUFRRVFJkTzFwQllnSDBta2ZES2VUMEpGZHFhTHJtWjJ4amVxdjZnYTNHYnlBNURlOEVHd05zdV81QnQ3RGd0QTVtZll1REx2RGxRQi1ZdENIWFpyUVppMG9adExrU0dQUUtJU2xEZmtsb0xXeDlNZ2FTejRiUnVGM09YUWxhOWJwRXNSQmFWcW56djhMUVl4Wk5JQnU3ak5US21tRjlRX3o1MmZHbURBdkpaZzFxMlRvV2lxNnhzR0VxUGktMWd2VWlWRDVpQlZLa0ZVUGZRcXlia29Yb1ZwWGZYaFhJZVFxV0k2RU5QTzJSNzUtZ2lwcUVHdV9pMFZwX2w2QktjWThNZ1pkRHY5NXIyV3B3X0ZRZjVhRUZFeXVRNENWVHczTEQyWlV2WUFTM1drdkhyaTFidFJvb21FV3I0RkxpWHJ0bURNcVlIcXA2bzA2M0JJME5McUt1N0ljbi10ak41b3ZJU1NHa0ZRTGVPcmhUeEZjYXlpdlJDcnhfOFJaYWZDbWtWVFZMSzhyM0dkbXk2M2lISVpDZEJXUVItUDlsS3BJcFZaMW5DWEJ5MHVjVWw3Rjc1bVJWeWltZmhJck43Q1Jjcm5CeEM0bUJKMWl6aVJ0ZkJpU0ZSeG5Lcm4wRnNHQ281c1RMNFpyODVpR1VOY0lhZXlRcGdYdU9ZTzdKX0t1T1FsdlU3dmVVeXhPSnNCZUFEcXlpX1F3UXBvVXRHbWhsWkRqSGE1TmZ2ZXZnTGZiYm8xdFF6NGw0Z1FqZ3VCM19FaloyMlUyQlVlMDh6VEY1NkE5bHBpUTlYeHdUa0xJY1V0eVBQb2NOUjNWdG5PSkhtUG81SnJmbFRWM0t5ZnNuS3RhNGJvU3hOTVNqNTM5Y0NkXzJacm0wTTBPeE0wcU9QUTBxOXdwTEljZW9JYU9wUHlBLWtjLUFtYmlGTkY3R19VZm93ajFhTGVSVjNfZXBsSkgxQmNaSG5fR2dBMlNwdS1sRzVTWUFRaTNqNWVSOXhqeFNwVUcwT3dqRHpsNGhyaHBqbHViQ2x1QTM5VWpsekpOQVJwZTgtMHc0TkFVY25jcmFDUlM1R19hY19kRkxISTY2eVpRYWtoTnpNRkIzUmtfcDFXbGhrZTl3Mmd2akxYeWpEZjI3ZjBmZl82UHJRekJUazRCazNvZ0FZc0JpRkZydEVpc1VtNVpTajAydVp4Wm8zUU5xaE5ON3lWd002d1RxQTUxYzdkeE1xb2lyZjEzb2FOS3dDTy1VbW5BSnRMT0ZHcVVzbUZBdEI3ZXhoc3B0TUJxTnB6cU1aZEY3cWZXUVI3UkZfMzBxWVhyZ1BibDI4Slhrek1FY0REWVJnN3FlUnFUdVhva0hCQVBveERlLWFQZWJzc3cydU8zQ0hvNC16X2F5U0xudG5OT2wwUF9tWm5mby1PeGJWRlE1aFN5MWVzSWtzd20wYktSM29GelIxQ3VkMnVzU25zLUh5RGhIYkY3WjdlQzIzTC1iUjllLTg5WW8yZEx3ZnNCajQxQTJEbk02SFNGYnJkTVZGN1ByQ1A1aFU0MC1ORzhBS1pPaGRfQmoyNHFzZ0c2enlxX29lMmZBdGZaT19sMGwxVEZpckV5dXhQak44MUdfdDNXaVdVSWhsZldsMnpIb2Q3M1BpaU5POVhBVDZzMjdTZXluQmdfYzk4cW1JbzVfaHhrZ0Exc1ZaTEhFNkM0MFFvNzdfYW5rcHlLQ1VfQ21fRWZuOEFzd1hzZExRNkRBYjdFMzNTOXdKN3BDWXVsT0hfRE16c04yMkN4alI2aC1mbGRXTEs5UnZ6LXpza0dyQ1AyMDh4c29BLTVjTTFiUjJtM3FVRnluRFY5RnFsRHY5dnpCa2UwWEV2eGxDNWtYMzNrbVRJTExaQXlFOVdNZlo5M1FHZGZGQVdCVVVUUzRnaFVoeTdOQXZsWnpUb1EtRUNzamZnaENnOGRtZ3hSdWdrLWZ1d3VIWUlzbjd6aktXaUNGRmhOSjFScUJ1ckd5aTlEM3JTaGc5ZDRkS0M1bGtuaVdCZVRyMmtyeXdWemJZNElJWVk2UzlBYkk2dmI0YzNuNFp0UWxiYjFlRzlGOWdLMnBBeEZQWDJTNnhBWC1pSXlTSnhTd3h1akE2QzZtcm8ycE9HSVFVVWFSTmJnQUMxX2JQMFBid3NVV2I5MzJ6SHY4NzVLZ2t0ckRhTEZvX0xXZTNfM040elBFbVg2SE9GdGdrcTUtXy1TY0JBeWduUTBhUmtIRS1hYzc0emxUUk1KUV95V2pMeHREbXdhZUdENVFjcExhbUxaMFRGZVNFUGpCZUpvSjlsQnMzRkxTcElLMFpFTkdhaXp0Z0FGXzRERVZNeDRLc194ZHYwdUpJcTk1QmRiREZrRW04RFVqbVVXejY2d2UyaExsYm16Z0R2M3JNVWhUWEE3cDNOdTdwNWdyZ09KdXo0QmI0d3JRejFuQmw4aVVmTTlUNllxSW1WYmRKR1pnaVFGWGNQb25JbmdLV0dBSDZnNlJFNGxPZ2tuQVpxWER5Y2R6aG1Jc3NqUDFpa216aUZ0V1JwanRtem1qeUJuSXB1bHpBb0NvSS1CWVp6NldUMzdxTUY4cl9CY3hvVGhxVGY1SEJiWDk4c0VTYlNJTkJYQlRJcmZyY05CVUhQLW1ITldQanYyOUJxNHBXNnN1djVnNU9SY0ExempnQ3VFMUpsS1l5a2dvczJ2cHFXZlhzaUtobldqd0hGM1YwS1k3dkdJUk9mNE9pZ3pzdnMxLW9fNHh6NGdIYWh5ZFVmSnNjRDFyQnZxYnJiV1FmTzJSZjVDSFNhdHd3TDJ4YVNPTmQxeVlGa2FXdTdhaW9WMmt5Y19FYVJfZVRRd2xEUU52aTVnZk1kYzE1bEVFZkF1UGFxU0Mxb0J2dmdIY2xUR3pvT2wyNmdfUWF5TlQ0UDdwQ1MyX1laS0tMNUlhYkFsMTRnd2VxTzBHa0g4cFdUYzhiQ1VmMlN6eUhXTXdNaUV1bnhqOTAtb3FxQzEyd2w1bjkwOVJSYU1zY0J3ZHNKN2MyaXUyQ2p5UGVhdkhMV3FwenN2d1ZBUHUyYmVsRDEyZC1MTlNlTlVOaFU4eE9xUF9KUXMzcENnanRPaER6TGNhQ1VLcHdGOENtRk54bWM0VmdadEU1QnpUMkRXbDJ5UC10bXoxRkxHamE2UlJFeFVSWjRDMXVBalJlM2ZiWmwwdHBWSk5sT250Tm9GbnBBYTQ3bXJYamRfTTJoMlpicEFpTk55RW5IN2RMOUNpYmNQWUtFbmEzUmR3NnNSMkxnMDZVcVRUazd3R0txMy1KSGNkdjU1MERaajllWjVGcFEtZzE5dWZpRGwwU0MyTEdZNWJZdTZVQjBUU1gwUFo0ZkJPam5PNUR4bWtSSEdVZ3pjT285bEI5VFpZWTZ5WHFYYUNWalBVNkZzZDk4aHp3RkNGNld5M29mOUd2MFdtNmRUZTU4S0tRZ0xxZHpWbXNTNTZLZzhjcGlFMHlFbXRxNUlPRExMYTJNQ3NIMlVMY0xoNjdRcndwWjZZb0trWjMzYUdQSEdySlBtTW1wSTN0cktxVzZGbDVCSllXdWhUUnpVaVZFZTcyamRYWE51aG9yU3A1QnM1cGFId0hqd0czb21ma05LT1o3cVJnX05vcUd0WGdoUWNyMGpxQjQxUUgxQ2FfdDJWdF9Dd0JXY2xyeWpQUXJRYkxUVHYzay1qTl9BbU1uUFVadklkTjBSOHhrSC14dnU5SzZWV0phbFhOUjl3Z283cWtucUZxUWltY1VDZG9oa0RyQ2w0czNtVjRjeGxjWW1VOTJqeC1PYTBBNXF4VnBTaGt0cVF0WVE2N3h0cV9PQkR6eF9VY0tHWFNpa1VqSEV2Y1NXTDFtMGtsLVJGY2pfUF8zQUpOMkNKSUVnVURHSnZJRUs0aG1oQmFYNHJFZ2lMcG1JcjhsZzQ4NEZvOWhMU0NqWWd0azRpakl4Wm9iT2M1bjg3cjRMOXhLaFMwQTdMd0hrRXY1RXgyTktUdUk5ZnNHOUFGX1VOYkFZUTdCUUpwcFpCZHlQRkpWVjduaDNyUllPOFkzQUlSYXJIUUEtUHhqbVhSUzdHZzhtb1pLMTJIVmc1R3pFUWJPb2xoSFE5X2hXeXhVR2lBVmJBdmtsRHlCd2pLOG04a0tlbjl3R1E3SWNPOFk3d3Fzak1KcFROSmJRVkE2TVJJMzBuNjE2LVptMDhtVU81Q0kzRmlrSjVQTzdHZWFMZFpJaW9GVkFpWWhDLTJfVVhWTVRvUlIyTHVwTHJ0R01GTDBZWE1TcXdyOVQ5bFUwd1JFc1VyT3FHWVRENEJaX1RubVZsSFRNQ0Z3bFU1TVhkYXFXQkFVMzBMQWJlN0Z2TUNpZzRuT3c5TjJ1c2VUMktxenpUY2oyR2o0MnJhSWF2eWxGOGxfMUM3SzNBRklid1pVSmM5TTN6RFMzX2Yyb2F5ZUthZEs4ajlsdVN5OHo3SXVYV0VmVEVRRFJkb205M3hYNzkwaFp4Mm9jTnFZdlQzSkoySkZaNXhNc3ZFdXJkT1ZpbUNWeE8yQmNVcnQzWW83bkFqNlQ1aUVGd2FpS3BPTWx3c0tMbURwa0hGd1hZV0VKVWZlc1ptcE9pREwzdld6TjREWVEtUWFOZlF1RXFjUENraGxvTW5SaW4tWXdQLXc0ZXhkczF4bU1mMHc2WElkbTZJWmtlakhBTnpzcGtNUXBpOG52SW1ISzNqRW01ejYzMktVTlFKNEw5M0F2dmFhR1QxRW9ON0tVaXVWWlhIdGFHbkNEbjd3bjF5NzFkR3VYbVN0RnBNakttVFpEWkxuSHFJaGpoRmlsc1FfUlNYeUxENTljZi1vMXNFbjN3ZU9rVUQ1UlFTeWl2V0VkOWEwUEExd3lJV0ozMllldzIzNFF0d1ZTeUtBQ1NQeGZLbFJMMmxWUTJRS1pvek5PMEszNmtRSmRadWM2bjBNLQ==)
        FCI_KEYSTORE_PASSWORD: Encrypted(Z0FBQUFBQmp4bE9FNzZBRFlHaU43RlFWa3MzMGNDdWU1czFVUnkzUElDYl9TM1RJanJJU0E1N2tYOTBscGgycmJIeklJdEhMNWNWU2p4UzJaUjRDeFk5SnlUNERidWxuYkZLMVlCUWxsUWMxdDgwVm0xaUpiVUk9)
        FCI_KEY_PASSWORD: Encrypted(Z0FBQUFBQmp4bE9FS1dxR2FFaFVEb01MZmlrNDg1RkdGS09zTlRFNndCNks4V2hXaUkyY094VHRWVzlYNl9EX0xQckJ3MnFfT0xXbENwdl9yMHpkb0pmX1JIQlNueW9pNHZHV0ZNNGhqN1oxUU1JVmFjR2xraGs9)
        FCI_KEY_ALIAS: Encrypted(Z0FBQUFBQmp4bE9FMmxvaFVKMzN3VDhxVHMwaTZxQnZ6dWlQMHFYM1JrUXNMRUlsVzg1cDJ3SnBzc2tzcUpCWnJqUGFqSUtzRW1xYk0weC1LYnUtS3VUWFZRM0tHLUxxS1E9PQ==)
      flutter: default
      xcode: latest
      cocoapods: default
    triggering:
      events:
        - push
      branch_patterns:
        - pattern: '*'
          include: true
          source: true
      tag_patterns:
        - pattern: '*'
          include: true
    scripts:
      - |
        # set up key.properties
        echo $FCI_KEYSTORE | base64 --decode > $FCI_KEYSTORE_PATH
        cat >> "$FCI_BUILD_DIR/android/key.properties" <<EOF
        storePassword=$FCI_KEYSTORE_PASSWORD
        keyPassword=$FCI_KEY_PASSWORD
        keyAlias=$FCI_KEY_ALIAS
        storeFile=/tmp/keystore.keystore
        EOF
      - |
        # set up local properties
        echo "flutter.sdk=$HOME/programs/flutter" > "$FCI_BUILD_DIR/android/local.properties"
      - flutter packages pub get
      - flutter build apk --release --build-name=1.0.5 --build-number=105
      - find . -name "Podfile" -execdir pod install \;
      - flutter build ios --release --no-codesign
    artifacts:
      - build/**/outputs/apk/**/*.apk
      - build/**/outputs/bundle/**/*.aab
      - build/**/outputs/**/mapping.txt
      - build/ios/ipa/*.ipa
      - /tmp/xcodebuild_logs/*.log
      - '*.snap'
      - build/windows/**/*.msix
      - flutter_drive.log
    publishing:
      email:
        recipients:
          - vrkic.stipe@gmail.com
      firebase:
        firebase_token: Encrypted(Z0FBQUFBQmp4bE9FT2hPQW9NcWRHcTJBcVVXd0gtajJWWGtmUk0zNm9BYmNIZzFkLWxsRmFBZDA3ZU1xVnlIZ3BlTDBSckxvS2M2b1cwSDhTRmpFcHd6XzZTdFFQZk94M1FBbnBfeWR0U2c5TEYtbmNySVExR0VUaWstdXJyUkV2My1nRjZhTXZaSy0=)
        ios:
          app_id: 1:461137054936:ios:458a3f029139ef4db89bad
          groups:
            - Owner
        android:
          app_id: 1:461137054936:android:13b7babdf9741aadb89bad
          groups:
            - Owner
            - Test
          artifact_type: apk
